# -*- coding: utf-8 -*-
"""DataProcessing.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gRdKnTQdfT6CaBVUPii8C3Y2HDQzGTgC
"""

import pandas as pd

df = pd.read_csv('Avocado.csv')
region_collection = {}
region_collection_reverse = {}
processing_data = df.copy()

# data processing
for col in df.columns:
  for i in range(len(df[col])):
    if col == 'type':
      if processing_data[col][i] == 'conventional':
        processing_data[col][i] = 0
      else:
        processing_data[col][i] = 1
    elif col == 'region':
      if processing_data[col][i] not in region_collection:
        region_collection[processing_data[col][i]] = len(region_collection)
        region_collection_reverse[len(region_collection)-1] = processing_data[col][i]
      processing_data[col][i] = region_collection[processing_data[col][i]]

processing_data['month'] = pd.DatetimeIndex(processing_data['Date']).month

training_data = processing_data.drop(['Unnamed: 0', 'Date', '4046', '4225', '4770', 'year', 'Total Bags',	'Small Bags',	'Large Bags',	'XLarge Bags'], axis=1)

training_data.to_csv('training_data.csv', index=False)